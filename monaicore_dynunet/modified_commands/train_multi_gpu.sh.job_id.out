/home/hju/run_monaicore/monaicore_dynunet/modified_commands
c0804a-s29.ufhpc
Tue Jan 31 20:16:09 EST 2023
Primary node: c0804a-s29
Primary TCP port: 30891
Secondary nodes: 
Running "/home/hju/run_monaicore/monaicore_dynunet/dynunet_pipeline/train.py -root_dir /mnt -datalist_path /mnt/dynunet/config/ -fold 0 -train_num_workers 4 -interval 1 -num_samples 1 -learning_rate 1e-1 -max_epochs 5 -task_id 04 -pos_sample_num 2 -expr_name baseline -tta_val True -multi_gpu True" on each node...
INFO:    underlay of /usr/bin/nvidia-smi required more than 50 (479) bind mounts
/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
MONAI version: 1.0.1
Numpy version: 1.22.2
Pytorch version: 1.13.0a0+d0d6b1f
MONAI flags: HAS_EXT = True, USE_COMPILED = False, USE_META_DICT = False
MONAI rev id: 8271a193229fe4437026185e218d5b06f7c8ce69
MONAI __file__: /opt/monai/monai/__init__.py

Optional dependencies:
Pytorch Ignite version: 0.4.10
Nibabel version: 4.0.2
scikit-image version: 0.19.3
Pillow version: 9.0.1
Tensorboard version: 2.10.0
gdown version: 4.5.3
TorchVision version: 0.14.0a0
tqdm version: 4.64.1
lmdb version: 1.3.0
psutil version: 5.9.2
pandas version: 1.4.4
einops version: 0.5.0
transformers version: 4.21.3
mlflow version: 1.30.0
pynrrd version: 1.0.0

For details about installing the optional dependencies, please visit:
    https://docs.monai.io/en/latest/installation.html#installing-the-recommended-dependencies

2023-01-31 20:19:51,011 - Added key: store_based_barrier_key:1 to store for rank: 1
2023-01-31 20:19:51,011 - Added key: store_based_barrier_key:1 to store for rank: 0
2023-01-31 20:19:51,011 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2023-01-31 20:19:51,011 - Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
Loading dataset:   0%|          | 0/26 [00:00<?, ?it/s]Loading dataset:   0%|          | 0/26 [00:00<?, ?it/s]Loading dataset:   4%|▍         | 1/26 [00:03<01:31,  3.67s/it]Loading dataset:   4%|▍         | 1/26 [00:03<01:31,  3.67s/it]Loading dataset:  54%|█████▍    | 14/26 [00:03<00:02,  5.12it/s]Loading dataset:  54%|█████▍    | 14/26 [00:03<00:02,  5.11it/s]Loading dataset: 100%|██████████| 26/26 [00:03<00:00,  6.74it/s]
Loading dataset: 100%|██████████| 26/26 [00:03<00:00,  6.71it/s]
Loading dataset:   0%|          | 0/104 [00:00<?, ?it/s]Loading dataset:   0%|          | 0/104 [00:00<?, ?it/s]Loading dataset:   1%|          | 1/104 [00:00<00:15,  6.69it/s]Loading dataset:   1%|          | 1/104 [00:00<00:15,  6.52it/s]Loading dataset:  16%|█▋        | 17/104 [00:00<00:01, 69.89it/s]Loading dataset:  16%|█▋        | 17/104 [00:00<00:01, 64.65it/s]Loading dataset:  29%|██▉       | 30/104 [00:00<00:00, 92.28it/s]Loading dataset:  26%|██▌       | 27/104 [00:00<00:01, 75.78it/s]Loading dataset:  38%|███▊      | 40/104 [00:00<00:00, 93.86it/s]Loading dataset:  39%|███▉      | 41/104 [00:00<00:00, 85.62it/s]Loading dataset:  48%|████▊     | 50/104 [00:00<00:00, 91.88it/s]Loading dataset:  50%|█████     | 52/104 [00:00<00:00, 90.79it/s]Loading dataset:  61%|██████    | 63/104 [00:00<00:00, 102.51it/s]Loading dataset:  62%|██████▏   | 64/104 [00:00<00:00, 98.55it/s]Loading dataset:  72%|███████▏  | 75/104 [00:00<00:00, 105.85it/s]Loading dataset:  72%|███████▏  | 75/104 [00:00<00:00, 91.45it/s]Loading dataset:  84%|████████▎ | 87/104 [00:00<00:00, 102.15it/s]Loading dataset:  82%|████████▏ | 85/104 [00:01<00:00, 92.89it/s]Loading dataset:  96%|█████████▌| 100/104 [00:01<00:00, 109.93it/s]Loading dataset: 100%|██████████| 104/104 [00:01<00:00, 99.31it/s] 
Loading dataset:  92%|█████████▏| 96/104 [00:01<00:00, 93.67it/s]Loading dataset: 100%|██████████| 104/104 [00:01<00:00, 88.67it/s]
NCCL version 2.15.1+cuda11.8
2023-01-31 20:20:01,326 - Added key: store_based_barrier_key:2 to store for rank: 1
2023-01-31 20:20:01,326 - Added key: store_based_barrier_key:2 to store for rank: 0
2023-01-31 20:20:01,326 - Rank 1: Completed store-based barrier for key:store_based_barrier_key:2 with 2 nodes.
2023-01-31 20:20:01,326 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 2 nodes.
2023-01-31 20:20:01,385 - Engine run resuming from iteration 0, epoch 0 until 5 epochs
is_namedtuple is deprecated, please use the python checks instead
is_namedtuple is deprecated, please use the python checks instead
2023-01-31 20:20:25,146 - Epoch: 1/5, Iter: 1/11 -- train_loss: 2.9982 
2023-01-31 20:20:25,234 - Reducer buckets have been rebuilt in this iteration.
2023-01-31 20:20:25,235 - Reducer buckets have been rebuilt in this iteration.
2023-01-31 20:20:25,282 - Epoch: 1/5, Iter: 2/11 -- train_loss: 2.0912 
2023-01-31 20:20:25,333 - Epoch: 1/5, Iter: 3/11 -- train_loss: 1.4721 
2023-01-31 20:20:25,384 - Epoch: 1/5, Iter: 4/11 -- train_loss: 1.2651 
2023-01-31 20:20:25,515 - Epoch: 1/5, Iter: 5/11 -- train_loss: 1.2240 
2023-01-31 20:20:25,610 - Epoch: 1/5, Iter: 6/11 -- train_loss: 1.2020 
2023-01-31 20:20:25,654 - Epoch: 1/5, Iter: 7/11 -- train_loss: 1.2074 
2023-01-31 20:20:25,720 - Epoch: 1/5, Iter: 8/11 -- train_loss: 1.1789 
2023-01-31 20:20:25,794 - Epoch: 1/5, Iter: 9/11 -- train_loss: 1.1556 
2023-01-31 20:20:25,867 - Epoch: 1/5, Iter: 10/11 -- train_loss: 1.1141 
2023-01-31 20:20:25,941 - Epoch: 1/5, Iter: 11/11 -- train_loss: 1.0832 
2023-01-31 20:20:25,941 - Engine run resuming from iteration 0, epoch 0 until 1 epochs
2023-01-31 20:20:31,573 - Got new best metric of val_mean_dice: 0.0
2023-01-31 20:20:31,573 - Epoch[1] Metrics -- val_mean_dice: 0.0000 
2023-01-31 20:20:31,573 - Key metric: val_mean_dice best value: 0.0 at epoch: 1
2023-01-31 20:20:31,700 - Epoch[1] Complete. Time taken: 00:00:05.736
2023-01-31 20:20:31,700 - Engine run complete. Time taken: 00:00:05.759
2023-01-31 20:20:31,730 - Key metric: None best value: -1 at epoch: -1
2023-01-31 20:20:31,730 - Epoch[1] Complete. Time taken: 00:00:30.071
2023-01-31 20:20:32,140 - Epoch: 2/5, Iter: 1/11 -- train_loss: 1.0665 
2023-01-31 20:20:32,214 - Epoch: 2/5, Iter: 2/11 -- train_loss: 1.0738 
2023-01-31 20:20:32,291 - Epoch: 2/5, Iter: 3/11 -- train_loss: 1.0427 
2023-01-31 20:20:32,366 - Epoch: 2/5, Iter: 4/11 -- train_loss: 1.0589 
2023-01-31 20:20:32,462 - Epoch: 2/5, Iter: 5/11 -- train_loss: 1.0348 
2023-01-31 20:20:32,530 - Epoch: 2/5, Iter: 6/11 -- train_loss: 1.0032 
2023-01-31 20:20:32,596 - Epoch: 2/5, Iter: 7/11 -- train_loss: 0.9959 
2023-01-31 20:20:32,671 - Epoch: 2/5, Iter: 8/11 -- train_loss: 0.9927 
2023-01-31 20:20:32,764 - Epoch: 2/5, Iter: 9/11 -- train_loss: 0.9702 
2023-01-31 20:20:32,832 - Epoch: 2/5, Iter: 10/11 -- train_loss: 0.9499 
2023-01-31 20:20:32,898 - Epoch: 2/5, Iter: 11/11 -- train_loss: 0.9802 
2023-01-31 20:20:32,899 - Engine run resuming from iteration 0, epoch 1 until 2 epochs
2023-01-31 20:20:35,024 - Epoch[2] Metrics -- val_mean_dice: 0.0000 
2023-01-31 20:20:35,024 - Key metric: val_mean_dice best value: 0.0 at epoch: 1
2023-01-31 20:20:35,024 - Epoch[2] Complete. Time taken: 00:00:02.095
2023-01-31 20:20:35,025 - Engine run complete. Time taken: 00:00:02.126
2023-01-31 20:20:35,063 - Key metric: None best value: -1 at epoch: -1
2023-01-31 20:20:35,063 - Epoch[2] Complete. Time taken: 00:00:03.333
2023-01-31 20:20:35,465 - Epoch: 3/5, Iter: 1/11 -- train_loss: 0.9297 
2023-01-31 20:20:35,538 - Epoch: 3/5, Iter: 2/11 -- train_loss: 0.9290 
2023-01-31 20:20:35,707 - Epoch: 3/5, Iter: 3/11 -- train_loss: 0.9026 
2023-01-31 20:20:35,823 - Epoch: 3/5, Iter: 4/11 -- train_loss: 0.9115 
2023-01-31 20:20:35,873 - Epoch: 3/5, Iter: 5/11 -- train_loss: 0.8839 
2023-01-31 20:20:35,922 - Epoch: 3/5, Iter: 6/11 -- train_loss: 0.8416 
2023-01-31 20:20:36,031 - Epoch: 3/5, Iter: 7/11 -- train_loss: 0.8328 
2023-01-31 20:20:36,125 - Epoch: 3/5, Iter: 8/11 -- train_loss: 0.8200 
2023-01-31 20:20:36,169 - Epoch: 3/5, Iter: 9/11 -- train_loss: 0.7802 
2023-01-31 20:20:36,236 - Epoch: 3/5, Iter: 10/11 -- train_loss: 0.7779 
2023-01-31 20:20:36,301 - Epoch: 3/5, Iter: 11/11 -- train_loss: 0.7572 
2023-01-31 20:20:36,301 - Engine run resuming from iteration 0, epoch 2 until 3 epochs
2023-01-31 20:20:38,382 - Got new best metric of val_mean_dice: 0.13773441314697266
2023-01-31 20:20:38,382 - Epoch[3] Metrics -- val_mean_dice: 0.1377 
2023-01-31 20:20:38,382 - Key metric: val_mean_dice best value: 0.13773441314697266 at epoch: 3
2023-01-31 20:20:38,472 - Epoch[3] Complete. Time taken: 00:00:02.144
2023-01-31 20:20:38,472 - Engine run complete. Time taken: 00:00:02.171
2023-01-31 20:20:38,511 - Key metric: None best value: -1 at epoch: -1
2023-01-31 20:20:38,511 - Epoch[3] Complete. Time taken: 00:00:03.448
2023-01-31 20:20:38,940 - Epoch: 4/5, Iter: 1/11 -- train_loss: 0.7450 
2023-01-31 20:20:39,040 - Epoch: 4/5, Iter: 2/11 -- train_loss: 0.7161 
2023-01-31 20:20:39,112 - Epoch: 4/5, Iter: 3/11 -- train_loss: 0.7214 
2023-01-31 20:20:39,231 - Epoch: 4/5, Iter: 4/11 -- train_loss: 0.7178 
2023-01-31 20:20:39,317 - Epoch: 4/5, Iter: 5/11 -- train_loss: 0.6900 
2023-01-31 20:20:39,383 - Epoch: 4/5, Iter: 6/11 -- train_loss: 0.6760 
2023-01-31 20:20:39,448 - Epoch: 4/5, Iter: 7/11 -- train_loss: 0.6570 
2023-01-31 20:20:39,567 - Epoch: 4/5, Iter: 8/11 -- train_loss: 0.6386 
2023-01-31 20:20:39,632 - Epoch: 4/5, Iter: 9/11 -- train_loss: 0.6384 
2023-01-31 20:20:39,718 - Epoch: 4/5, Iter: 10/11 -- train_loss: 0.6316 
2023-01-31 20:20:39,784 - Epoch: 4/5, Iter: 11/11 -- train_loss: 0.6153 
2023-01-31 20:20:39,784 - Engine run resuming from iteration 0, epoch 3 until 4 epochs
2023-01-31 20:20:41,921 - Got new best metric of val_mean_dice: 0.4418812096118927
2023-01-31 20:20:41,922 - Epoch[4] Metrics -- val_mean_dice: 0.4419 
2023-01-31 20:20:41,922 - Key metric: val_mean_dice best value: 0.4418812096118927 at epoch: 4
2023-01-31 20:20:42,041 - Epoch[4] Complete. Time taken: 00:00:02.226
2023-01-31 20:20:42,041 - Engine run complete. Time taken: 00:00:02.257
2023-01-31 20:20:42,074 - Key metric: None best value: -1 at epoch: -1
2023-01-31 20:20:42,074 - Epoch[4] Complete. Time taken: 00:00:03.563
2023-01-31 20:20:42,519 - Epoch: 5/5, Iter: 1/11 -- train_loss: 0.6492 
2023-01-31 20:20:42,595 - Epoch: 5/5, Iter: 2/11 -- train_loss: 0.6148 
2023-01-31 20:20:42,671 - Epoch: 5/5, Iter: 3/11 -- train_loss: 0.5903 
2023-01-31 20:20:42,747 - Epoch: 5/5, Iter: 4/11 -- train_loss: 0.6025 
2023-01-31 20:20:42,819 - Epoch: 5/5, Iter: 5/11 -- train_loss: 0.5839 
2023-01-31 20:20:42,905 - Epoch: 5/5, Iter: 6/11 -- train_loss: 0.6401 
2023-01-31 20:20:43,009 - Epoch: 5/5, Iter: 7/11 -- train_loss: 0.5976 
2023-01-31 20:20:43,078 - Epoch: 5/5, Iter: 8/11 -- train_loss: 0.5896 
2023-01-31 20:20:43,154 - Epoch: 5/5, Iter: 9/11 -- train_loss: 0.5781 
2023-01-31 20:20:43,243 - Epoch: 5/5, Iter: 10/11 -- train_loss: 0.5734 
2023-01-31 20:20:43,312 - Epoch: 5/5, Iter: 11/11 -- train_loss: 0.5551 
2023-01-31 20:20:43,312 - Engine run resuming from iteration 0, epoch 4 until 5 epochs
2023-01-31 20:20:45,441 - Got new best metric of val_mean_dice: 0.4830015003681183
2023-01-31 20:20:45,441 - Epoch[5] Metrics -- val_mean_dice: 0.4830 
2023-01-31 20:20:45,441 - Key metric: val_mean_dice best value: 0.4830015003681183 at epoch: 5
2023-01-31 20:20:45,528 - Epoch[5] Complete. Time taken: 00:00:02.190
2023-01-31 20:20:45,529 - Engine run complete. Time taken: 00:00:02.216
2023-01-31 20:20:45,569 - Key metric: None best value: -1 at epoch: -1
2023-01-31 20:20:45,569 - Epoch[5] Complete. Time taken: 00:00:03.494
2023-01-31 20:20:45,569 - Engine run complete. Time taken: 00:00:44.183
