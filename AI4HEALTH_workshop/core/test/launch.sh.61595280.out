/home/hju/monai_uf_tutorials/monaicore_multigpu/unet_ddp/test
c1004a-s11.ufhpc
Tue Apr 11 18:22:53 EDT 2023
Primary node: c1004a-s11
Primary TCP port: 21243
Secondary nodes: 
Running "/home/hju/monai_uf_tutorials/monaicore_multigpu/unet_ddp/unet_training_ddp.py" on each node...
INFO:    underlay of /usr/bin/nvidia-smi required more than 50 (479) bind mounts
/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2023-04-11 18:23:08,538 - Added key: store_based_barrier_key:1 to store for rank: 0
2023-04-11 18:23:08,548 - Added key: store_based_barrier_key:1 to store for rank: 1
2023-04-11 18:23:08,558 - Added key: store_based_barrier_key:1 to store for rank: 2
2023-04-11 18:23:08,558 - Added key: store_based_barrier_key:1 to store for rank: 3
2023-04-11 18:23:08,558 - Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-11 18:23:08,558 - Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-11 18:23:08,558 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-11 18:23:08,558 - Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
[0] generating synthetic data to ./testdata (this may take a while)
NCCL version 2.15.1+cuda11.8
<class 'monai.transforms.utility.array.AsChannelFirst'>: Class `AsChannelFirst` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.
<class 'monai.transforms.utility.array.AsChannelFirst'>: Class `AsChannelFirst` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.
<class 'monai.transforms.utility.array.AsChannelFirst'>: Class `AsChannelFirst` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.
<class 'monai.transforms.utility.array.AsChannelFirst'>: Class `AsChannelFirst` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.
monai.networks.nets.unet UNet.__init__:dimensions: Argument `dimensions` has been deprecated since version 0.6. Please use `spatial_dims` instead.
monai.networks.nets.unet UNet.__init__:dimensions: Argument `dimensions` has been deprecated since version 0.6. Please use `spatial_dims` instead.
monai.networks.nets.unet UNet.__init__:dimensions: Argument `dimensions` has been deprecated since version 0.6. Please use `spatial_dims` instead.
monai.networks.nets.unet UNet.__init__:dimensions: Argument `dimensions` has been deprecated since version 0.6. Please use `spatial_dims` instead.
[2] cuda:2 ---------- epoch 1/5
[3] cuda:3 ---------- epoch 1/5
[1] cuda:1 ---------- epoch 1/5
[0] cuda:0 ---------- epoch 1/5
is_namedtuple is deprecated, please use the python checks instead
is_namedtuple is deprecated, please use the python checks instead
is_namedtuple is deprecated, please use the python checks instead
is_namedtuple is deprecated, please use the python checks instead
[1] 1/32, train_loss: 0.6024
[0] 1/32, train_loss: 0.6537
[2] 1/32, train_loss: 0.7216
[3] 1/32, train_loss: 0.6297
2023-04-11 18:23:21,339 - Reducer buckets have been rebuilt in this iteration.
2023-04-11 18:23:21,339 - Reducer buckets have been rebuilt in this iteration.
2023-04-11 18:23:21,339 - Reducer buckets have been rebuilt in this iteration.
2023-04-11 18:23:21,340 - Reducer buckets have been rebuilt in this iteration.
[1] 2/32, train_loss: 0.5626
[2] 2/32, train_loss: 0.6314
[0] 2/32, train_loss: 0.5356
[3] 2/32, train_loss: 0.5062
[1] 3/32, train_loss: 0.4997
[2] 3/32, train_loss: 0.5202
[0] 3/32, train_loss: 0.4973
[3] 3/32, train_loss: 0.5305
[0] 4/32, train_loss: 0.5155
[3] 4/32, train_loss: 0.5042
[1] 4/32, train_loss: 0.5132
[2] 4/32, train_loss: 0.5272
[2] 5/32, train_loss: 0.4618
[0] 5/32, train_loss: 0.5068
[1] 5/32, train_loss: 0.5339
[3] 5/32, train_loss: 0.6273
[2] 6/32, train_loss: 0.4393
[1] 6/32, train_loss: 0.5001
[0] 6/32, train_loss: 0.4562
[3] 6/32, train_loss: 0.4995
[0] 7/32, train_loss: 0.4796
[1] 7/32, train_loss: 0.5041
[2] 7/32, train_loss: 0.4719
[3] 7/32, train_loss: 0.4888
[2] 8/32, train_loss: 0.5382
[0] 8/32, train_loss: 0.4536
[3] 8/32, train_loss: 0.4589
[1] 8/32, train_loss: 0.4821
[2] epoch 1, average loss: 0.5389
[2] cuda:2 ---------- epoch 2/5
[3] epoch 1, average loss: 0.5306
[3] cuda:3 ---------- epoch 2/5
[0] epoch 1, average loss: 0.5123
[0] cuda:0 ---------- epoch 2/5
[1] epoch 1, average loss: 0.5248
[1] cuda:1 ---------- epoch 2/5
[3] 1/32, train_loss: 0.5562
[1] 1/32, train_loss: 0.5038
[0] 1/32, train_loss: 0.4814
[2] 1/32, train_loss: 0.4912
[3] 2/32, train_loss: 0.4866
[1] 2/32, train_loss: 0.4743
[0] 2/32, train_loss: 0.4242
[2] 2/32, train_loss: 0.4943
[1] 3/32, train_loss: 0.4331
[0] 3/32, train_loss: 0.4656
[2] 3/32, train_loss: 0.4668
[3] 3/32, train_loss: 0.5041
[3] 4/32, train_loss: 0.4526
[2] 4/32, train_loss: 0.5241
[0] 4/32, train_loss: 0.4457
[1] 4/32, train_loss: 0.4600
[1] 5/32, train_loss: 0.4755
[0] 5/32, train_loss: 0.4504
[2] 5/32, train_loss: 0.4632
[3] 5/32, train_loss: 0.5619
[1] 6/32, train_loss: 0.4650
[0] 6/32, train_loss: 0.4844
[2] 6/32, train_loss: 0.4675
[3] 6/32, train_loss: 0.4057
[1] 7/32, train_loss: 0.4192
[0] 7/32, train_loss: 0.4478
[3] 7/32, train_loss: 0.4222
[2] 7/32, train_loss: 0.5170
[2] 8/32, train_loss: 0.4497
[0] 8/32, train_loss: 0.4573
[3] 8/32, train_loss: 0.3821
[1] 8/32, train_loss: 0.3860
[2] epoch 2, average loss: 0.4842
[2] cuda:2 ---------- epoch 3/5
[3] epoch 2, average loss: 0.4714
[3] cuda:3 ---------- epoch 3/5
[1] epoch 2, average loss: 0.4521
[1] cuda:1 ---------- epoch 3/5
[0] epoch 2, average loss: 0.4571
[0] cuda:0 ---------- epoch 3/5
[0] 1/32, train_loss: 0.4392
[1] 1/32, train_loss: 0.4540
[3] 1/32, train_loss: 0.4919
[2] 1/32, train_loss: 0.4602
[3] 2/32, train_loss: 0.4301
[2] 2/32, train_loss: 0.5106
[1] 2/32, train_loss: 0.3776
[0] 2/32, train_loss: 0.4237
[1] 3/32, train_loss: 0.4828
[2] 3/32, train_loss: 0.4504
[0] 3/32, train_loss: 0.4737
[3] 3/32, train_loss: 0.3937
[2] 4/32, train_loss: 0.4617
[1] 4/32, train_loss: 0.4507
[0] 4/32, train_loss: 0.4453
[3] 4/32, train_loss: 0.4092
[2] 5/32, train_loss: 0.4920
[0] 5/32, train_loss: 0.4139
[3] 5/32, train_loss: 0.4140
[1] 5/32, train_loss: 0.4650
[2] 6/32, train_loss: 0.3832
[3] 6/32, train_loss: 0.4261
[1] 6/32, train_loss: 0.4183
[0] 6/32, train_loss: 0.4160
[0] 7/32, train_loss: 0.3812
[3] 7/32, train_loss: 0.4220
[1] 7/32, train_loss: 0.5252
[2] 7/32, train_loss: 0.3933
[2] 8/32, train_loss: 0.4289
[1] 8/32, train_loss: 0.5228
[3] 8/32, train_loss: 0.4360
[0] 8/32, train_loss: 0.4091
[1] epoch 3, average loss: 0.4621
[1] cuda:1 ---------- epoch 4/5
[0] epoch 3, average loss: 0.4253
[0] cuda:0 ---------- epoch 4/5
[2] epoch 3, average loss: 0.4475
[2] cuda:2 ---------- epoch 4/5
[3] epoch 3, average loss: 0.4279
[3] cuda:3 ---------- epoch 4/5
[2] 1/32, train_loss: 0.5349
[0] 1/32, train_loss: 0.4401
[1] 1/32, train_loss: 0.4104
[3] 1/32, train_loss: 0.3925
[2] 2/32, train_loss: 0.3487
[1] 2/32, train_loss: 0.4145
[3] 2/32, train_loss: 0.4357
[0] 2/32, train_loss: 0.5324
[2] 3/32, train_loss: 0.3747
[1] 3/32, train_loss: 0.4025
[0] 3/32, train_loss: 0.4072
[3] 3/32, train_loss: 0.5685
[2] 4/32, train_loss: 0.4020
[0] 4/32, train_loss: 0.3282
[3] 4/32, train_loss: 0.4255
[1] 4/32, train_loss: 0.3959
[0] 5/32, train_loss: 0.4188
[2] 5/32, train_loss: 0.4008
[3] 5/32, train_loss: 0.3623
[1] 5/32, train_loss: 0.4727
[0] 6/32, train_loss: 0.4261
[3] 6/32, train_loss: 0.3751
[2] 6/32, train_loss: 0.4051
[1] 6/32, train_loss: 0.4395
[2] 7/32, train_loss: 0.3336
[1] 7/32, train_loss: 0.4452
[3] 7/32, train_loss: 0.4191
[0] 7/32, train_loss: 0.3804
[2] 8/32, train_loss: 0.4446
[0] 8/32, train_loss: 0.4857
[3] 8/32, train_loss: 0.4272
[1] 8/32, train_loss: 0.4067
[2] epoch 4, average loss: 0.4055
[2] cuda:2 ---------- epoch 5/5
[0] epoch 4, average loss: 0.4274
[0] cuda:0 ---------- epoch 5/5
[3] epoch 4, average loss: 0.4257
[3] cuda:3 ---------- epoch 5/5
[1] epoch 4, average loss: 0.4234
[1] cuda:1 ---------- epoch 5/5
[1] 1/32, train_loss: 0.5227[2] 1/32, train_loss: 0.4048

[3] 1/32, train_loss: 0.3930
[0] 1/32, train_loss: 0.4600
[3] 2/32, train_loss: 0.5589
[1] 2/32, train_loss: 0.3889
[2] 2/32, train_loss: 0.4007
[0] 2/32, train_loss: 0.3363
[1] 3/32, train_loss: 0.3604
[2] 3/32, train_loss: 0.3784
[0] 3/32, train_loss: 0.4512
[3] 3/32, train_loss: 0.3375
[1] 4/32, train_loss: 0.4049
[2] 4/32, train_loss: 0.3717
[3] 4/32, train_loss: 0.3962
[0] 4/32, train_loss: 0.3691
[1] 5/32, train_loss: 0.4349
[0] 5/32, train_loss: 0.4003
[3] 5/32, train_loss: 0.3861
[2] 5/32, train_loss: 0.4089
[2] 6/32, train_loss: 0.3796
[0] 6/32, train_loss: 0.3738
[3] 6/32, train_loss: 0.3634
[1] 6/32, train_loss: 0.4946
[1] 7/32, train_loss: 0.3986
[0] 7/32, train_loss: 0.3694
[3] 7/32, train_loss: 0.3749
[2] 7/32, train_loss: 0.4373
[1] 8/32, train_loss: 0.3906
[2] 8/32, train_loss: 0.4436
[0] 8/32, train_loss: 0.4260
[3] 8/32, train_loss: 0.3400
[2] epoch 5, average loss: 0.4031
[2] train completed, epoch losses: [0.5389443747699261, 0.4842173419892788, 0.4475271850824356, 0.40554967522621155, 0.40312790870666504]
[1] epoch 5, average loss: 0.4245
[1] train completed, epoch losses: [0.5247707813978195, 0.4521115869283676, 0.46205518394708633, 0.42343011125922203, 0.42445021495223045]
[0] epoch 5, average loss: 0.3982
[0] train completed, epoch losses: [0.5122993886470795, 0.4570777751505375, 0.42525961250066757, 0.4273684360086918, 0.3982482813298702]
[3] epoch 5, average loss: 0.3937
[3] train completed, epoch losses: [0.5306321382522583, 0.4714306741952896, 0.42787082120776176, 0.4257286824285984, 0.39374247565865517]
