/home/hju/monai_uf_tutorials/monaicore_multigpu/unet_ddp/test
c1004a-s11.ufhpc
Tue Apr 11 18:29:38 EDT 2023
Primary node: c1004a-s11
Primary TCP port: 11869
Secondary nodes: 
Running "/home/hju/monai_uf_tutorials/monaicore_multigpu/unet_ddp/unet_training_ddp_torchrun.py" on each node...
INFO:    underlay of /usr/bin/nvidia-smi required more than 50 (479) bind mounts
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2023-04-11 18:29:52,679 - Added key: store_based_barrier_key:1 to store for rank: 0
2023-04-11 18:29:52,679 - Added key: store_based_barrier_key:1 to store for rank: 2
2023-04-11 18:29:52,690 - Added key: store_based_barrier_key:1 to store for rank: 3
2023-04-11 18:29:52,690 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-11 18:29:52,690 - Added key: store_based_barrier_key:1 to store for rank: 1
2023-04-11 18:29:52,690 - Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-11 18:29:52,690 - Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2023-04-11 18:29:52,690 - Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
[0] generating synthetic data to ./testdata (this may take a while)
NCCL version 2.15.1+cuda11.8
<class 'monai.transforms.utility.array.AsChannelFirst'>: Class `AsChannelFirst` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.
<class 'monai.transforms.utility.array.AsChannelFirst'>: Class `AsChannelFirst` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.
<class 'monai.transforms.utility.array.AsChannelFirst'>: Class `AsChannelFirst` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.
<class 'monai.transforms.utility.array.AsChannelFirst'>: Class `AsChannelFirst` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.
monai.networks.nets.unet UNet.__init__:dimensions: Argument `dimensions` has been deprecated since version 0.6. Please use `spatial_dims` instead.
monai.networks.nets.unet UNet.__init__:dimensions: Argument `dimensions` has been deprecated since version 0.6. Please use `spatial_dims` instead.
monai.networks.nets.unet UNet.__init__:dimensions: Argument `dimensions` has been deprecated since version 0.6. Please use `spatial_dims` instead.
monai.networks.nets.unet UNet.__init__:dimensions: Argument `dimensions` has been deprecated since version 0.6. Please use `spatial_dims` instead.
[3] cuda:3 ---------- epoch 1/5
[1] cuda:1 ---------- epoch 1/5
[0] cuda:0 ---------- epoch 1/5
[2] cuda:2 ---------- epoch 1/5
is_namedtuple is deprecated, please use the python checks instead
is_namedtuple is deprecated, please use the python checks instead
is_namedtuple is deprecated, please use the python checks instead
is_namedtuple is deprecated, please use the python checks instead
[2] 1/32, train_loss: 0.7604
[1] 1/32, train_loss: 0.6492
[3] 1/32, train_loss: 0.6643
[0] 1/32, train_loss: 0.6722
2023-04-11 18:30:05,334 - Reducer buckets have been rebuilt in this iteration.
2023-04-11 18:30:05,334 - Reducer buckets have been rebuilt in this iteration.
2023-04-11 18:30:05,334 - Reducer buckets have been rebuilt in this iteration.
2023-04-11 18:30:05,334 - Reducer buckets have been rebuilt in this iteration.
[0] 2/32, train_loss: 0.5836
[2] 2/32, train_loss: 0.6858
[3] 2/32, train_loss: 0.5249
[1] 2/32, train_loss: 0.5750
[0] 3/32, train_loss: 0.5097
[3] 3/32, train_loss: 0.5608
[2] 3/32, train_loss: 0.5510
[1] 3/32, train_loss: 0.5379
[0] 4/32, train_loss: 0.5428
[3] 4/32, train_loss: 0.5367
[2] 4/32, train_loss: 0.5692
[1] 4/32, train_loss: 0.5407
[0] 5/32, train_loss: 0.5601
[3] 5/32, train_loss: 0.6382
[2] 5/32, train_loss: 0.4965
[1] 5/32, train_loss: 0.5604
[0] 6/32, train_loss: 0.4772
[3] 6/32, train_loss: 0.5212
[2] 6/32, train_loss: 0.4561
[1] 6/32, train_loss: 0.5153
[0] 7/32, train_loss: 0.5026
[3] 7/32, train_loss: 0.4838
[1] 7/32, train_loss: 0.5080
[2] 7/32, train_loss: 0.5034
[0] 8/32, train_loss: 0.4617
[3] 8/32, train_loss: 0.4778
[2] 8/32, train_loss: 0.5557
[1] 8/32, train_loss: 0.5165
[0] epoch 1, average loss: 0.5387
[0] cuda:0 ---------- epoch 2/5
[1] epoch 1, average loss: 0.5504
[1] cuda:1 ---------- epoch 2/5
[3] epoch 1, average loss: 0.5510
[3] cuda:3 ---------- epoch 2/5
[2] epoch 1, average loss: 0.5723
[2] cuda:2 ---------- epoch 2/5
[3] 1/32, train_loss: 0.5484
[0] 1/32, train_loss: 0.5131
[1] 1/32, train_loss: 0.5232
[2] 1/32, train_loss: 0.5063
[2] 2/32, train_loss: 0.4909
[1] 2/32, train_loss: 0.4710
[3] 2/32, train_loss: 0.5271
[0] 2/32, train_loss: 0.4480
[0] 3/32, train_loss: 0.4745
[1] 3/32, train_loss: 0.4178
[3] 3/32, train_loss: 0.5347
[2] 3/32, train_loss: 0.4713
[0] 4/32, train_loss: 0.4536
[3] 4/32, train_loss: 0.4734
[1] 4/32, train_loss: 0.4692
[2] 4/32, train_loss: 0.5588
[0] 5/32, train_loss: 0.4610
[3] 5/32, train_loss: 0.6095
[1] 5/32, train_loss: 0.4752
[2] 5/32, train_loss: 0.4604
[0] 6/32, train_loss: 0.5057
[3] 6/32, train_loss: 0.4062
[1] 6/32, train_loss: 0.4860
[2] 6/32, train_loss: 0.4712
[0] 7/32, train_loss: 0.4667
[1] 7/32, train_loss: 0.4342
[2] 7/32, train_loss: 0.5224
[3] 7/32, train_loss: 0.4170
[3] 8/32, train_loss: 0.3923
[1] 8/32, train_loss: 0.3717
[2] 8/32, train_loss: 0.4879
[0] 8/32, train_loss: 0.4614
[0] epoch 2, average loss: 0.4730
[0] cuda:0 ---------- epoch 3/5
[3] epoch 2, average loss: 0.4886
[3] cuda:3 ---------- epoch 3/5
[1] epoch 2, average loss: 0.4561
[1] cuda:1 ---------- epoch 3/5
[2] epoch 2, average loss: 0.4962
[2] cuda:2 ---------- epoch 3/5
[3] 1/32, train_loss: 0.5131
[2] 1/32, train_loss: 0.5066
[1] 1/32, train_loss: 0.4536
[0] 1/32, train_loss: 0.4418
[0] 2/32, train_loss: 0.4424
[2] 2/32, train_loss: 0.4942
[3] 2/32, train_loss: 0.4513
[1] 2/32, train_loss: 0.3913
[1] 3/32, train_loss: 0.4988
[2] 3/32, train_loss: 0.4660
[0] 3/32, train_loss: 0.4691
[3] 3/32, train_loss: 0.4044
[0] 4/32, train_loss: 0.4621
[1] 4/32, train_loss: 0.4407
[2] 4/32, train_loss: 0.4884
[3] 4/32, train_loss: 0.4190
[0] 5/32, train_loss: 0.4227
[2] 5/32, train_loss: 0.5177
[1] 5/32, train_loss: 0.4932
[3] 5/32, train_loss: 0.4263
[0] 6/32, train_loss: 0.4193
[2] 6/32, train_loss: 0.3839[1] 6/32, train_loss: 0.4245
[3] 6/32, train_loss: 0.4243

[0] 7/32, train_loss: 0.3805
[3] 7/32, train_loss: 0.4398
[1] 7/32, train_loss: 0.5408
[2] 7/32, train_loss: 0.4006
[0] 8/32, train_loss: 0.4200
[2] 8/32, train_loss: 0.4458
[3] 8/32, train_loss: 0.4699
[1] 8/32, train_loss: 0.5423
[1] epoch 3, average loss: 0.4731
[1] cuda:1 ---------- epoch 4/5
[2] epoch 3, average loss: 0.4629
[2] cuda:2 ---------- epoch 4/5
[3] epoch 3, average loss: 0.4435
[3] cuda:3 ---------- epoch 4/5
[0] epoch 3, average loss: 0.4322
[0] cuda:0 ---------- epoch 4/5
[3] 1/32, train_loss: 0.3913[2] 1/32, train_loss: 0.5762

[0] 1/32, train_loss: 0.4403
[1] 1/32, train_loss: 0.4426
[0] 2/32, train_loss: 0.5490
[2] 2/32, train_loss: 0.3766
[1] 2/32, train_loss: 0.4191
[3] 2/32, train_loss: 0.4550
[2] 3/32, train_loss: 0.3748
[3] 3/32, train_loss: 0.6024
[1] 3/32, train_loss: 0.4195
[0] 3/32, train_loss: 0.4062
[2] 4/32, train_loss: 0.4160
[0] 4/32, train_loss: 0.3476
[1] 4/32, train_loss: 0.4182
[3] 4/32, train_loss: 0.4758
[3] 5/32, train_loss: 0.3949
[2] 5/32, train_loss: 0.4019
[0] 5/32, train_loss: 0.4334
[1] 5/32, train_loss: 0.4864
[0] 6/32, train_loss: 0.4475
[3] 6/32, train_loss: 0.3862
[1] 6/32, train_loss: 0.4705
[2] 6/32, train_loss: 0.4211
[3] 7/32, train_loss: 0.4427
[1] 7/32, train_loss: 0.4547
[2] 7/32, train_loss: 0.3467
[0] 7/32, train_loss: 0.3965
[3] 8/32, train_loss: 0.4341
[0] 8/32, train_loss: 0.4882[2] 8/32, train_loss: 0.4495

[1] 8/32, train_loss: 0.4421
[1] epoch 4, average loss: 0.4441
[1] cuda:1 ---------- epoch 5/5
[3] epoch 4, average loss: 0.4478
[3] cuda:3 ---------- epoch 5/5
[0] epoch 4, average loss: 0.4386
[0] cuda:0 ---------- epoch 5/5
[2] epoch 4, average loss: 0.4203
[2] cuda:2 ---------- epoch 5/5
[3] 1/32, train_loss: 0.4281
[1] 1/32, train_loss: 0.5503
[2] 1/32, train_loss: 0.4320
[0] 1/32, train_loss: 0.4714
[1] 2/32, train_loss: 0.4139
[3] 2/32, train_loss: 0.5832
[0] 2/32, train_loss: 0.3525
[2] 2/32, train_loss: 0.4006
[3] 3/32, train_loss: 0.3689
[1] 3/32, train_loss: 0.3672
[2] 3/32, train_loss: 0.3889
[0] 3/32, train_loss: 0.4582
[3] 4/32, train_loss: 0.4005
[1] 4/32, train_loss: 0.4184
[0] 4/32, train_loss: 0.3733
[2] 4/32, train_loss: 0.3902
[3] 5/32, train_loss: 0.3903
[1] 5/32, train_loss: 0.4656
[2] 5/32, train_loss: 0.4192
[0] 5/32, train_loss: 0.3783
[1] 6/32, train_loss: 0.4806
[0] 6/32, train_loss: 0.4091
[2] 6/32, train_loss: 0.4091
[3] 6/32, train_loss: 0.3763
[3] 7/32, train_loss: 0.4006
[0] 7/32, train_loss: 0.3655
[1] 7/32, train_loss: 0.3980
[2] 7/32, train_loss: 0.4768
[3] 8/32, train_loss: 0.3697
[1] 8/32, train_loss: 0.4375
[2] 8/32, train_loss: 0.4659
[0] 8/32, train_loss: 0.4620
[1] epoch 5, average loss: 0.4414[3] epoch 5, average loss: 0.4147
[1] train completed, epoch losses: [0.5503610670566559, 0.4560520127415657, 0.47314290329813957, 0.4441486746072769, 0.44142892956733704]

[3] train completed, epoch losses: [0.5509718805551529, 0.48857204988598824, 0.44349897652864456, 0.4477898105978966, 0.4146895706653595]
[2] epoch 5, average loss: 0.4228
[2] train completed, epoch losses: [0.5722698345780373, 0.4961531423032284, 0.4628933481872082, 0.42033790051937103, 0.4228285811841488]
[0] epoch 5, average loss: 0.4088
[0] train completed, epoch losses: [0.5387463271617889, 0.47300196439027786, 0.43224815651774406, 0.4385939724743366, 0.408798698335886]
